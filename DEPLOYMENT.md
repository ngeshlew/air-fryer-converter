# üöÄ Air Fryer Converter - Deployment Guide

This guide walks you through deploying the Air Fryer Converter app to Railway (backend) and Netlify (frontend).

## Prerequisites

- GitHub account
- Railway account (https://railway.app)
- Netlify account (https://netlify.com)
- PostgreSQL database (provided by Railway)

## üì¶ Part 1: Backend Deployment (Railway)

### Step 1: Push Code to GitHub

```bash
# Ensure all changes are committed
git add -A
git commit -m "Prepare for deployment"
git push origin main
```

### Step 2: Set Up Railway Project

1. Go to https://railway.app
2. Click "New Project"
3. Select "Deploy from GitHub repo"
4. Choose your `air-fryer-converter` repository
5. Railway will detect the backend automatically

### Step 3: Add PostgreSQL Database

1. In your Railway project, click "New"
2. Select "Database" ‚Üí "PostgreSQL"
3. Railway will create a database and provide `DATABASE_URL`
4. The `DATABASE_URL` is automatically added to your backend service

### Step 4: Configure Backend Service

1. Click on your backend service
2. Go to "Settings" ‚Üí "Environment Variables"
3. Add these variables:
   ```
   NODE_ENV=production
   PORT=3001
   DATABASE_URL=[auto-generated by Railway]
   ```

### Step 5: Configure Build & Start Commands

Railway should auto-detect, but verify:

**Root Directory:** `server`

**Build Command:**
```bash
npm install && npx prisma generate && npm run build
```

**Start Command:**
```bash
npm start
```

### Step 6: Run Database Migrations

1. In Railway, go to your backend service
2. Click "Settings" ‚Üí "Deploy"
3. Add a one-time deploy command:
   ```bash
   npx prisma migrate deploy
   ```
4. This creates the database tables

### Step 7: Get Backend URL

1. Railway will provide a public URL like: `https://your-app.railway.app`
2. Copy this URL - you'll need it for the frontend

### Step 8: Test Backend

Visit: `https://your-app.railway.app/api/health`

You should see:
```json
{
  "status": "healthy",
  "timestamp": "...",
  "database": "connected"
}
```

## üé® Part 2: Frontend Deployment (Netlify)

### Step 1: Set Up Netlify Project

1. Go to https://netlify.com
2. Click "Add new site" ‚Üí "Import an existing project"
3. Connect to GitHub and select your `air-fryer-converter` repo
4. Configure build settings

### Step 2: Configure Build Settings

**Base directory:** Leave empty (root)

**Build command:**
```bash
npm install && npm run build
```

**Publish directory:**
```bash
dist
```

### Step 3: Add Environment Variables

In Netlify, go to "Site configuration" ‚Üí "Environment variables"

Add:
```
VITE_API_URL=https://your-railway-backend-url.railway.app
```

Replace `your-railway-backend-url.railway.app` with your actual Railway backend URL from Step 7 above.

### Step 4: Deploy

1. Click "Deploy site"
2. Netlify will build and deploy your app
3. You'll get a URL like: `https://random-name-123456.netlify.app`

### Step 5: Custom Domain (Optional)

1. In Netlify, go to "Domain management"
2. Click "Add custom domain"
3. Follow instructions to configure DNS

### Step 6: Test Frontend

1. Visit your Netlify URL
2. Test the calculator on the home page
3. Check if Recipe of the Day loads (will be empty until you add data)
4. Navigate to `/recipes` page

## üîß Part 3: Populating Sample Data

Since web scraping is not yet implemented, you can add sample recipes directly to the database.

### Option A: Using Railway's PostgreSQL Console

1. In Railway, click on your PostgreSQL database
2. Go to "Query"
3. Run this SQL to add a sample recipe:

```sql
INSERT INTO recipes (
  id, title, description, image_url, source_url, supermarket,
  cook_time, difficulty, servings, ingredients, instructions, tags,
  is_active, is_featured
) VALUES (
  'sample-recipe-1',
  'Air Fryer Banana Chips',
  'Crispy, healthy banana chips made in your air fryer. Perfect snack for any time!',
  'https://images.unsplash.com/photo-1603833665858-e61d17a86224',
  'https://www.aldi.co.uk/recipes/collections/air-fryer/air-fryer-banana-chips',
  'ALDI',
  15,
  'EASY',
  2,
  '["3 ripe bananas", "1 tbsp lemon juice", "Pinch of salt", "Optional: cinnamon"]'::jsonb,
  '["Slice bananas thinly (about 3mm thick)", "Toss banana slices with lemon juice", "Arrange in single layer in air fryer basket", "Cook at 180¬∞C for 15 minutes", "Shake basket at 8 minutes", "Cook until crispy and golden"]'::jsonb,
  ARRAY['healthy', 'snack', 'quick'],
  true,
  true
);
```

### Option B: Using Prisma Studio (Development)

1. Locally, run: `cd server && npx prisma studio`
2. Add recipes through the UI
3. Data will sync to Railway database

## üìä Part 4: Monitoring & Maintenance

### Railway Monitoring

- **Logs:** View real-time logs in Railway dashboard
- **Metrics:** Monitor CPU, memory, and request metrics
- **Database:** View database usage and connection count

### Netlify Monitoring

- **Analytics:** View page views and traffic
- **Deploy Log:** Check build logs for errors
- **Performance:** Monitor Core Web Vitals

## üêõ Troubleshooting

### Backend Issues

**Problem:** "Cannot connect to database"
- **Solution:** Check `DATABASE_URL` in Railway environment variables
- Ensure PostgreSQL service is running

**Problem:** "Module not found" errors
- **Solution:** Ensure `npx prisma generate` runs in build command
- Check that all dependencies are in `package.json`

### Frontend Issues

**Problem:** "Network error" when loading recipes
- **Solution:** Check `VITE_API_URL` is correct in Netlify
- Ensure Railway backend is running

**Problem:** "Recipe of the Day" shows "No recipes available"
- **Solution:** Add sample recipes to database (see Part 3)
- Set `is_featured = true` for at least one recipe

### CORS Issues

**Problem:** "CORS policy" errors in browser console
- **Solution:** Backend has `cors()` enabled, but verify Railway URL matches Netlify origin
- Check Railway backend logs for CORS errors

## üîÑ Continuous Deployment

Both Railway and Netlify support automatic deployments:

1. **Push to GitHub:** `git push origin main`
2. **Railway:** Automatically rebuilds backend
3. **Netlify:** Automatically rebuilds frontend
4. Changes go live in ~2-5 minutes

## üìù Post-Deployment Checklist

- [ ] Backend health check returns "healthy"
- [ ] Frontend loads without errors
- [ ] Calculator converts temperatures correctly
- [ ] Settings page theme switcher works
- [ ] Navigation works (Home, Recipes, Settings)
- [ ] Mobile navigation appears on mobile
- [ ] Desktop sidebar appears on desktop
- [ ] At least one sample recipe added
- [ ] Recipe of the Day displays
- [ ] Recipe detail page loads

## üéâ Your App is Live!

Frontend: `https://your-app.netlify.app`  
Backend: `https://your-app.railway.app`

Share your Air Fryer Converter with friends and family!

## üìö Next Steps

1. **Add More Recipes:** Populate database with more recipes
2. **Implement Web Scraping:** Add scrapers for ALDI, Waitrose, etc. (see Todo 6)
3. **Analytics:** Add Google Analytics or Plausible
4. **PWA:** Enable service worker for offline support
5. **SEO:** Add meta tags and sitemap
6. **Custom Domain:** Configure your own domain name

## üÜò Need Help?

- **Railway Docs:** https://docs.railway.app
- **Netlify Docs:** https://docs.netlify.com
- **Prisma Docs:** https://www.prisma.io/docs
- **GitHub Issues:** Open an issue in your repository

---

**Deployed with ‚ù§Ô∏è using Railway + Netlify**

